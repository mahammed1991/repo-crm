 {% extends 'layouts/main.html' %}

{% load staticfiles %}

{% block title %}
CSAT Reports
{% endblock title %}

{% block main_css %}
<link rel="stylesheet" href="{% static 'css/reports/csat_reports.css' %}">
<link href="{% static 'css/reports/jquery.comiseo.daterangepicker.css' %}" rel="stylesheet">
{% endblock main_css %}

{% block content %}
<section class="content-region inner-page">
  <div class="container-fluid">
  <h1>CSAT REPORTS</h1>
 
  
    <div class="row">
      <div class="col-md-6 ms2">
         <div class="col-md-12">
            <div class="dropdown">
              <button class="btn btn-default dropdown-toggle mcsatbut" type="button" id="dropdownMenu1">
                <div class="msbutton1">
                <span class="mcsatbut2">Choose Filters</span><br><span class="mcsatbut3">Single or Multi-Select</span>
                </div><div class="msbutton2"><span class="glyphicon glyphicon-chevron-down"></span></div>
              </button>
              <div class="col-xs-12 msdrop ms ms_none" id="msid" aria-labelledby="dropdownMenu1" style="width:100% !important;line-height: 32px;border: 1px solid rgba(0, 0, 0, .15);margin-top: 2px; display:block;">
                    <div class="col-xs-12 col-md-12 mscol1 ms2">
                        <div class="mscol1a msc12">
                            <input class="msc1a3" type="checkbox" name="" id="sel_all" value=""><span class="msc14" style="padding-left: 5%;">Select All</span>
                        </div>
                    </div>
                    <div class="col-xs-12 col-md-12 mscol1 ms2">
                        
                        <div class="mscol1a mscol1a2">
                            <span class="msc14">Survey Category </span>
                        </div>
                        <div class="mscol1a msc12">
                            <input class="msc13 " id="survey_category_mapped" type="checkbox" name="survey_category_mapped" value="Mapped"><span class="msc15">Mapped</span>
                        </div>
                        <div class="mscol1a msc12">
                            <input class="msc13 " id="survey_category_unmapped" type="checkbox" name="survey_category_unmapped" value="Unmapped"><span class="msc15">Unmapped</span>
                        </div>
                        
                    </div>
                    
                    <div class="col-xs-12 col-md-12 mscol1 ms2">
                        <div class="mscol1a mscol1a2">
                            <span class="msc14 ">Survey Channel </span>
                        </div>
                        <div class="mscol1a msc12">
                            <input class="msc13 " id="suervey_channel_phone" type="checkbox" name="suervey_channel_phone" value="Phone"><span class="msc15">Phone</span>
                        </div>
                        <div class="mscol1a msc12">
                            <input class="msc13 " id="suervey_channel_email" type="checkbox" name="suervey_channel_email" value="Email"><span class="msc15">Email</span>
                        </div>
                        <div class="mscol1a msc12">
                            <input class="msc13 " id="suervey_channel_combined" type="checkbox" name="suervey_channel_combined" value="Combined"><span class="msc15">Combined</span>
                        </div>
                    </div>
                    
                    <div class="col-xs-12 col-md-12 mscol1 ms2">
                        <div class="mscol1a mscol1a2">
                            <span class="msc14">Language Category</span>
                        </div>
                        <div class="mscol1a msc12">
                            <input class="msc13 " id="language_english" type="checkbox" name="language_english" value="English"><span class="msc15"> English</span>
                        </div>
                        <div class="mscol1a msc12">
                            <input class="msc13 " id="language_non_english" type="checkbox" name="language_non_english" value="Non-English"><span class="msc15">Non-English</span>
                        </div>
                        <div class="mscol1a msc12">
                            <input class="msc13 " id="language_combined" type="checkbox" name="language_combined" value="Combined"><span class="msc15">Combined</span>
                        </div>
                    </div>
                    
                    <div class="col-xs-12 col-md-12 mscol1 ms2">
                        <div class="mscol1a mscol1a2">
                            <span class="msc14 ">Tagteam Process</span>
                        </div>
                        <div class="mscol1a msc12">
                            <input class="msc13 "  id="process_tag" type="checkbox" name="process_tag" value="Tag"><span class="msc15">Tag</span>
                        </div>
                        <div class="mscol1a msc12">
                            <input class="msc13 " id="process_shopping" type="checkbox" name="process_shopping" value="Shopping"><span class="msc15">Shopping</span>
                        </div>
                        <div class="mscol1a msc12">
                            <input class="msc13 " id="process_combined" type="checkbox" name="process_combined" value="Combined"><span class="msc15">Combined</span>
                        </div>
                    </div>
                    
                    <div class="col-xs-12 col-md-12 mscol1 ms2">
                        <div class="mscol1a mscol1a2">
                            <span class="msc14">Tagteam Location</span>
                        </div>
                        <div class="mscol1a msc12">
                            <input class="msc13 " id="tag_location_bangalore" type="checkbox" name="tag_location_bangalore" value="Bangalore"><span class="msc15">Bangalore</span>
                        </div>
                        <div class="mscol1a msc12">
                            <input class="msc13 " id="tag_location_palo_alto" type="checkbox" name="tag_location_palo_alto" value="Palo alto"><span class="msc15">Palo alto</span>
                        </div>
                        <div class="mscol1a msc12">
                            <input class="msc13 " id="tag_location_combined" type="checkbox" name="tag_location_combined" value="Combined"><span class="msc15">Combined</span>
                        </div>
                    </div>
             </div>
            </div>
         </div> 
         
      </div>
      <div class="col-md-3">
        <div class="dropdown mm1">
              <button class="btn btn-default mcsatbut mcsatbuta2" type="button" id="dropdownMenu1">
                <div class="msbutton1">
                <span class="mcsatbut2">Choose Report Type</span><br><span class="mcsatbut3">Single-Select</span>
                </div><div class="msbutton2"><span class="glyphicon glyphicon-chevron-down"></span></div>
              </button>
              <ul class="dropdown-menu msdrop msdropa2 report-type" style="display:block;position:relative;">
                <li><a href="#" class="msdropa"><span class="glyphicon glyphicon-ok mcico"></span>Region</a></li>
                <li><a href="#" class="msdropa"><span class="glyphicon glyphicon-ok mcico"></span>Program</a></li>
                <li><a href="#" class="msdropa"><span class="glyphicon glyphicon-ok mcico"></span>Location</a></li>
                <li><a href="#" class="msdropa"><span class="glyphicon glyphicon-ok mcico"></span>Language</a></li>
                <li><a href="#" class="msdropa"><span class="glyphicon glyphicon-ok mcico"></span>Code Type</a></li>
                <li><a href="#" class="msdropa"><span class="glyphicon glyphicon-ok mcico"></span>Lead Owner</a></li>
                <li><a href="#" class="msdropa"><span class="glyphicon glyphicon-ok mcico"></span>Platform</a></li>
                
              </ul>
        </div>
      </div>
      <div class="col-md-3 mm2">
         <div class="dropdown">
              <button class="btn btn-default  mcsatbut mcsatbuta2" type="button" id="dropdownMenu1">
                <div class="msbutton1">
                <span class="mcsatbut2">Choose Timeline</span>
                </div><div class="msbutton2"><span class="glyphicon glyphicon-chevron-down"></span></div>
              </button>
              <div class="dropdown-menu" style="display:block;   padding: 0px 0; border:0px solid transparent">
              <ul class="dropdown-menu2a msdrop msdropa2 timeline" style="display:block;position:relative;  box-shadow: none;">
                <li><a href="#" class="msdropa"><span class="glyphicon glyphicon-ok mcico"></span>Custom Date Range</a></li>
                <li><a href="#" class="msdropa"><span class="glyphicon glyphicon-ok mcico"></span>This Week</a></li>
                <li><a href="#" class="msdropa"><span class="glyphicon glyphicon-ok mcico"></span>This Month</a></li>
                <li><a href="#" class="msdropa"><span class="glyphicon glyphicon-ok mcico"></span>This Quarter</a></li>
                
              </ul>

            <ul class="msdropa2" style="position:relative;">
                     <li style="background:#fff;display:none;border-bottom: 0px solid transparent;" id="custome_date">
                    <input type="text" id="datepickerFrom" class="msc16" placeholder="Start Date">
                    <input class="msc16" id="datepickerTo" type="text" placeholder="End Date">
                </li>
            </ul>
            </div>
        </div>
      </div>
        
     
    </div>
    
    <div class="row msc17" >
         <div class="btn-group" style="clear:both;">
                    <button id="viewButton" class="btn std-btn">Submit</button><br>
                    <div style="width:100%;float: left; text-align:left;"><br>
                    <input class="comp" type="checkbox" name="comparison" id="comparison"><span class="msc15" style="width: 100%;padding-left:2px;">Compare Current vs Previous</span>
                    </div>

        </div>
    </div>
    
    <div class="row msc17" >
         <div class="col-xs-12">
                <ul id="myselect">
                    
                </ul>

        </div>
        <div class="col-xs-12">
            <div class="table-responsive">
              <table class="table table-condensed table-bordered">
                <tr >
                    <th class="msc24">Region</th>
                    <th class="msc24">Survey Channel</th>
                    <th class="msc24">Response Type</th>
                    <th class="msc24">Leads</th>
                    <th class="msc24">Wins</th>
                    <th class="msc24">Actual</th>
                    <th class="msc24">vs Target</th>
                    <th class="msc24">Extremely Satisfied</th>
                    <th class="msc24">Moderately Satisfied</th>
                    <th class="msc24">Slightly Satisfied</th>
                    <th class="msc24">Neither satisfied nor dissatisfied</th>
                    <th class="msc24">Slightly dissatisfied</th>
                    <th class="msc24">Moderately satisfied</th>
                    <th class="msc24">Extremely satisfied</th>
                    <th class="msc23">Grand Total</th>
                    
                </tr>
                <tr>
                    <td>Americas</td>
                    <td>Phone</td>
                    <td>Phone</td>
                    <td style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td>Actual</td>
                    <td>vs Target</td>
                    <td style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td style="padding: 0px !important;" class="msc23">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    
                </tr>
                <tr>
                    <td>Americas</td>
                    <td>Phone</td>
                    <td>Phone</td>
                    <td style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td>Actual</td>
                    <td>vs Target</td>
                    <td style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td style="padding: 0px !important;" class="msc23">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    
                </tr>
                <tr>
                    <td class="msc23">Americas</td>
                    <td class="msc23">Phone</td>
                    <td class="msc23">Phone</td>
                    <td class="msc23" style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td class="msc23" style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td class="msc23">Actual</td>
                    <td class="msc23">vs Target</td>
                    <td class="msc23" style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td class="msc23" style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td class="msc23" style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td class="msc23" style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td class="msc23" style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td class="msc23" style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td  class="msc23" style="padding: 0px !important;">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    <td style="padding: 0px !important;" class="msc23">
                        <div class="msc20">0000</div>
                        <div class="msc21">00.00%</div>
                    </td>
                    
                </tr>
              </table>
            </div>
        </div>
    </div>
    

   <!--  <div class="btns text-center" id="submit_buttons">
        <div class="btn-group">
            <button class="btn std-btn">Submit</button>
            <button class="btn std-btn grayed" onclick="resetBtn(this);" id="formReset">Reset</button>
        </div>
    </div> -->
 
  </div>
</section>
{% endblock %}

{% block main_js %}
<link href="{% static 'css/reports/jquery.comiseo.daterangepicker.css' %}" rel="stylesheet">
<script src="{% static 'js/reports/jquery.min.js' %}"></script>
<script src="{% static 'js/reports/jquery-ui.min.js' %}"></script>
<script src="{% static 'js/reports/moment.min.js' %}"></script>
<script src="{% static 'js/reports/jquery.comiseo.daterangepicker.js' %}"></script>
<script>
$(document).ready(function() {
    window.reportType = '';
    window.filters = new Array();
    window.timeline = new Array();
    $(function() {
        $("#datepickerFrom").datepicker({
          defaultDate : "+1w",
          changeMonth : true,
          numberOfMonths : 1,
          dateFormat: "M dd, yy",
          onClose : function(selectedDate) {
            $("#to").datepicker("option", "minDate", selectedDate);
          },
          onSelect: function (selected) {
                var dt = new Date(selected);
                dt.setDate(dt.getDate() + 1);
                $("#datepickerTo").datepicker("option", "minDate", dt);
            }
        });
        $("#datepickerTo").datepicker({
          defaultDate : "+1w",
          changeMonth : true,
          numberOfMonths : 1,
          dateFormat: "M dd, yy",
          onClose : function(selectedDate) {
            $("#from").datepicker("option", "maxDate", selectedDate);
          },
          onSelect: function (selected) {
                var dt = new Date(selected);
                dt.setDate(dt.getDate() - 1);
                $("#datepickerFrom").datepicker("option", "maxDate", dt);
            }
        });

    });


     $('#msid input[type="checkbox"]').click(function() {
         if ($(this).attr('id') == "sel_all") {
            window.filters = [];
             $('.msc13').prop('checked', false);
             $('.msc18').remove();
             if ($('#sel_all').prop('checked') == true) {
                 $('.msc13 ').trigger("click");
             } else {
                 $('.msc13 ').attr('checked', false)
                 $('.msc18').remove();
             }
         }
         if ($(this).is(":checked")) {
             var se = $(this).attr('id');
             var val1 = $(this).val();
             window.filters.push(se);
             if (se != 'sel_all') {
                 $("#myselect").append('<li class="msc18" >' + val1 + '<span id="we-' + se + '" class="glyphicon glyphicon-remove msc19"></span></li>');
             }
         } else if ($(this).is(":not(:checked)")) {
             
             $('#sel_all').prop('checked', false);
             var se = $(this).attr('id');

             eleIndex = window.filters.indexOf(se);
             window.filters.splice(eleIndex, 1);

             var remov = "#we-" + se;
             $(remov).parent().remove();

         }
     });

 });

 $(document).on('click', '.msc19', function() {
     $('#sel_all').prop('checked', false);
     var iim = $(this).attr('id');
     var arr1 = iim.split('-');
     var arr2 = "#" + arr1[1];
     $(arr2).attr('checked', false);
     $(this).parent().remove();
 });

 $(document).on('click', '.report-type li', function() {
    window.reportType = '';
    window.reportType = $(this).text();
    var thischeck = $(this).find('.mcico');
    $('.mm1 .mcico').css('display','none');
    $('.mm1 .report-type li').css('background','#fff');
    $('.mm1 .report-type li a').css('color','#474747');
    $(this).css('background','#1e66c6','color','#fff');
    $(this).find('a').css('color','#fff');
    $(thischeck).css('display','inline-block');

 });

 $(document).on('click', '.timeline li', function() {
    window.timeline = []
    window.timeline.push($(this).text());
    $("#datepickerFrom").val('');
    $("#datepickerTo").val('');
    if($(this).text() == "Custom Date Range"){
        $('#custome_date').show();
    }
    if($(this).text().indexOf('This') != -1){
         $('#custome_date').hide();
    }
     var thischeck = $(this).find('.mcico');
     $('.mm2 .mcico').css('display', 'none');
     $('.mm2 .timeline li').css('background', '#fff');
     $('.mm2 .timeline li a').css('color', '#474747');
     $(this).css('background', '#1e66c6', 'color', '#fff');
     $(this).find('a').css('color', '#fff');
     $(thischeck).css('display', 'inline-block');

 }); 

$('#viewButton').on('click', function(){
    var isError = false;
    var data = {}
    if(window.filters.length == 0){
        isError = true;
        alert("Please Select Any One Filter From Choose Filter Section!")
    } else{
        data['filter'] = window.filters;
    }

    if(window.reportType == ''){
        isError = true;
        alert("Please Choose Report Type Report Section!")
    } else{
        data['report_type'] = window.reportType;
    }

    if(window.timeline.length == 0){
        isError = true;
        alert("Please Choose Timeline Section!")
    } else{
        if(window.timeline[0] == 'Custom Date Range'){
            fromDate = $("#datepickerFrom").val();
            toDate = $("#datepickerTo").val();
            if(fromDate && toDate){
                data['timeline'] = [fromDate, toDate]
            } else{
                isError = true;
                alert("Please Custome Date Range From Calendar")
            }

        } else{
            data['timeline'] = window.timeline[0];
        }
    }

    if($('#comparison').prop('checked') == true){
        data['comparison'] = 'yes';
    }else{
        data['comparison'] = '';
    }

    if(isError){
        alert('Failure!');
        return false;
    }else{
        console.log(data);
        alert('Success!');
        $.ajax({
            method: 'GET',
            url: '/reports/csat-reports',
            data: data,
            dataType: "json",
            success: function(data) {
                console.log('Success Response From Ajax');
                console.log(data);
            },
            error: function(jqXHR, textStatus, errorThrown) {
                console.log('Failure');
            }
        })
    }
});

</script>
{% endblock main_js %}